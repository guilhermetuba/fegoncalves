<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Recebimentos</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background-color: #f4f4f4;
    }
    .container {
      max-width: 400px;
      margin: auto;
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }
    label {
      font-weight: bold;
      margin-top: 10px;
      display: block;
    }
    input, select {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      margin-bottom: 15px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    button {
      width: 100%;
      padding: 10px;
      background: #6f42c1;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    button:hover {
      background: #5a32a3;
    }
    .link-button {
      display: block;
      text-align: center;
      color: #6f42c1;
      text-decoration: none;
      font-weight: bold;
    }
    .link-button:hover {
      text-decoration: underline;
    }
    .link-bottom {
      margin-top: 15px;
    }
  </style>
</head>
<body>

  <div class="container">
    <a href="index.html" class="link-button">Voltar para o Início</a>
    <h2>Recebimentos</h2>

    <form id="pagamentoForm">
      <label for="cliente">Cliente:</label>
      <select id="cliente" name="cliente" required>
        <option value="">Selecione um cliente</option>
        <!-- opções serão preenchidas via JavaScript -->
      </select>

      <label for="parcela">Parcela em Aberto:</label>
      <select id="parcela" name="parcela" required>
        <option value="">Selecione uma parcela</option>
        <!-- opções serão preenchidas conforme o cliente -->
      </select>

      <label for="valor">Valor Recebido:</label>
      <input type="number" id="valor" name="valor" required step="0.01" min="0">

      <label for="dataPagamento">Data do Pagamento:</label>
      <input type="date" id="dataPagamento" name="dataPagamento" required>

      <button type="submit">Confirmar recebimento</button>
      <a href="index.html" class="link-button link-bottom">Voltar para o Início</a>
    </form>
  </div>

  <script>
    // Define a data atual no campo de data
    document.getElementById("dataPagamento").valueAsDate = new Date();

    // Em breve: buscar clientes e parcelas via API ou Google Sheets
    async function carregarClientes() {
  try {
    const res = await fetch('https://meu-backend-xi.vercel.app/api/consulta_cliente');
    const clientes = await res.json();

    const selectCliente = document.getElementById("cliente");
    selectCliente.innerHTML = '<option value="">Selecione um cliente</option>';

    clientes.forEach(cliente => {
      const option = document.createElement("option");
      option.value = cliente.nome;
      option.textContent = cliente.nome;
      selectCliente.appendChild(option);
    });
  } catch (error) {
    console.error("Erro ao carregar clientes:", error);
    alert("Erro ao carregar clientes.");
  }
}

carregarClientes();

    document.getElementById("pagamentoForm").addEventListener("submit", function(event) {
      event.preventDefault();

      const cliente = document.getElementById("cliente").value;
      const parcela = document.getElementById("parcela").value;
      const valor = parseFloat(document.getElementById("valor").value);
      const dataPagamento = document.getElementById("dataPagamento").value;

      if (!cliente || !parcela || isNaN(valor) || !dataPagamento) {
        alert("Preencha todos os campos corretamente.");
        return;
      }

      // Aqui vai a lógica de atualização da aba Contas a Receber
      console.log("Registrando pagamento de", valor, "na parcela", parcela, "do cliente", cliente, "na data", dataPagamento);

      alert("Pagamento registrado (simulado). Em breve integrará com o backend!");
      // Depois: resetar o form, atualizar parcelas, etc.
    });
  </script>

</body>
</html>
